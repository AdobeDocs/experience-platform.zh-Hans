---
title: Adobe管理主機概述
description: 瞭解在Adobe Experience Platform中部署標籤程式庫組建的預設託管選項。
exl-id: 9042c313-b0d3-4f6e-963d-0051d760fd16
source-git-commit: 85b428b3997d53cbf48e4f112e5c09c0f40f7ee1
workflow-type: tm+mt
source-wordcount: '1173'
ht-degree: 60%

---

# Adobe-managed 主机概述

>[!NOTE]
>
>Adobe Experience Platform Launch已經過品牌重塑，現在是Adobe Experience Platform中的一套資料收集技術。 因此，产品文档中的术语有一些改动。有关术语更改的综合参考，请参阅以下[文档](../../../term-updates.md)。

Adobe管理主機是您在Adobe Experience Platform中部署標籤程式庫組建時的預設主機設定。 當您透過「資料收集」使用者介面建立新屬性時，系統會為您建立預設的Adobe管理主機。

凭借 Adobe-managed 主机，可将库版本交付至已与 Adobe 签约的第三方内容分发网络 (CDN)。由于这些 CDN 独立于 Adobe 运行，因此即使 Platform 正在进行维护或由于其他原因而停止运行，您的部署代码仍可以在站点和应用程序中继续正常运转。Adobe-managed 主机的嵌入代码引用了 CDN 上的主要库文件，因此客户端设备可在运行时检索文件。

本檔案概述Platform中的Adobe管理主機，並提供在UI中建立新Adobe管理主機的步驟。

## Akamai

目前，[Akamai](https://www.akamai.com/cn/zh/) 是 Adobe 的主要 CDN 提供商。Akamai 构建的可靠 CDN 旨在为全球大容量 Web 访客受众提供内容。CDN 运行的冗余网络由负载均衡、地理优化的节点构成，可以尽快为遍布全球的访客提供内容。

具体而言，Akamai 在 87 个国家/地区运行着 137,000 多台服务器，涉及超过 1,150 个网络。在備援方面，CDN不僅可以從一台伺服器路由到另一台伺服器，而且還可以視需要從一個伺服器節點路由到另一個伺服器節點。 换句话说，每个节点都由多台服务器组成，因此一台服务器的停机绝不会导致问题，因为同一节点上的其他服务器可以接管这台停机的服务器。

如果整個節點停止運作，Akamai會從具有相同快取內容的最近節點提供內容。 节点是根据访客位置、流量负载和其他因素动态选取的，因此，始终能够通过最适合每个访客的当地节点提供内容。

托管在 Akamai 上的文件将使用域 `assets.adobedtm.com`。判断能否安全引用域（`http://` 或 `https://`）时，取决于您在嵌入代码 `<script>` 中调用上述域的方式。

>[!WARNING]
>
>如果您没有将库托管在 Akamai 网络上，那么 Platform 则无法阻止因此而引发的任何错误。

## 库版本缓存

使用 Adobe-managed 主机时，您的库版本会缓存到以下两个位置：

* [边缘缓存](#edge)
* [浏览器缓存](#browser)

### 边缘缓存 {#edge}

CDN的主要用途是以智慧化方式將內容發佈至地理位置上較接近使用者的伺服器，讓使用者端裝置可以更快擷取內容。 CDN 通过以下方法来实现上述目标：生成的内容副本适用于遍布在世界各地的服务器（“边缘节点”）。

当您的库版本部署到 Adobe-managed 主机后，CDN 会把该版本分发到多台中央服务器（“原点”），这些服务器随后会将库版本的副本发送至全球大量不同的边缘节点，以此来进行缓存。最终，客户端设备会获得存储在这些边缘节点上的库缓存版本。

![](../images/cdn-diagram.png)

>[!NOTE]
>
>对于 Adobe-managed 主机而言，发布到任何新环境的首个库，最多可能需要五分钟即可传送到遍布全球的 CDN。

邊緣節點收到特定檔案（例如程式庫組建）的請求時，會先檢查檔案的到期時間。 如果時間未過期，邊緣節點會提供快取版本。 如果時間已過期，邊緣節點會向最近的來源索取新復本、提供最新的復本，然後以新的過期時間快取最新復本。

>[!NOTE]
>
>除边缘节点缓存之外，还可能存在执行自身缓存的中间网络（例如，公司网络或移动网络）。如果您的版本未按预期进行缓存，根本原因可能在于这些中间网络。

#### 边缘缓存失效 {#invalidation}

上傳新的程式庫組建時，所有適用邊緣節點上的快取都會失效。 這表示無論擷取最新副本的時間有多近，每個節點都會將其快取版本視為無效。 在某个边缘节点下次收到针对该文件的请求时，这个节点会再次从原点检索新副本。

由於Akamai具有多個來源伺服器，且這些伺服器會相互複製檔案，加上無法得知哪個來源會先收到您的檔案，因此這些節點請求可能會送到沒有最新版本的原始伺服器。 然後它會再次快取較舊的版本。 為避免發生此情況，會依下列時間間隔，對每個新組建執行多次快取無效判定：

* 上传后立即执行
* 上传 5 分钟后执行
* 上传 60 分钟后执行

这些交错的缓存失效设置为原点服务器组提供了相互复制文件最新版本的时间，以便都能检索到最新版本的文件。

### 浏览器缓存 {#browser}

除此之外，还可以通过使用 `cache-control` HTTP 标头，在浏览器上缓存库版本。使用 Adobe-managed 主机时，由于无法控制 API 响应中返回的标头，因此采用了 Adobe 默认缓存设置。换句话说，您无法对 Adobe-managed 主机使用自定义标头。如果要自定义 `cache-control` 标头，则需要考虑选用[自托管](self-hosting-libraries.md)的方法来代替。

瀏覽器快取型程式庫組建的到期時間(由 `cache-control` header)的值會依您使用的標籤環境而有所不同：

| 环境 | `cache-control` 值 |
| --- | --- |
| 开发 | `max-age=0, no-cache, no-store` |
| 暂存 | `max-age=0, no-cache, no-store` |
| 生产 | `max-age=3600` |

如上表所示，开发环境和暂存环境不支持浏览器缓存。因此，您不应在高流量或生产环境中使用开发或暂存嵌入代码。

快取控制標頭僅適用於主要程式庫組建。 主库下的所有子资源始终被视为新资源，因此无需在浏览器中缓存它们。

## 在 UI 中使用 Adobe-managed 托管

您在Platform UI或資料收集UI中首次建立屬性時，系統會自動為您建立Adobe管理主機。 依預設，所有具有立即可用屬性的可用環境也會指派給Adobe管理主機。

>[!NOTE]
>
>如果默认的 Adobe-managed 主机未从所有环境中分配，则可以删除该主机。如果要在执行此操作后切换回 Adobe-managed 主机，可通过以下步骤创建新主机：
>
>1. 選取 **[!UICONTROL 主機]** 索引標籤中的內容，然後選取 **[!UICONTROL 新增主機]**.
>1. 提供主機的名稱，選取 **[!UICONTROL 由Adobe管理]** 作為主機型別，然後選取 **[!UICONTROL 儲存]**.

>
>接下来，您可以根据需要将环境重新分配给 Adobe-managed 主机。

## 后续步骤

本文概述了Adobe Experience Platform中標籤程式庫的Adobe管理託管。 有关其他托管选项的信息，请参阅以下文档：

* [SFTP 托管](./sftp-host.md)
* [自托管库](./self-hosting-libraries.md)

有关如何管理环境中的主机的详细信息，请参阅[环境指南](../environments.md)。
