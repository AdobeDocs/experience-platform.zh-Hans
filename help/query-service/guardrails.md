---
keywords: Experience Platform；查询；查询服务；故障诊断；护栏；准则；限制；
title: 查询服务的防护
description: 本文档提供了有关查询服务数据使用限制的信息，以帮助您优化查询使用。
exl-id: 1ad5dcf4-d048-49ff-97e3-07040392b65b
source-git-commit: 14e3eff3ea2469023823a35ee1112568f5b5f4f7
workflow-type: tm+mt
source-wordcount: '1029'
ht-degree: 2%

---

# 查询服务的防护

护栏是指用于指导数据和系统使用情况、性能优化以及避免在Adobe Experience Platform中出现错误或意外结果的阈值。

本文档提供查询服务数据的默认使用限制，以帮助您在查询与许可授权相关的数据时优化系统性能。

## 先决条件

在继续阅读本文档之前，您应该对关键查询服务的定义和功能有很好的了解。 下面介绍了这些功能：

* **临时查询**:执行 `SELECT` 查询，以在查询结果的位置浏览、实验和验证数据 **未存储** 在数据湖上。

* **批量查询**:执行 `INSERT TABLE AS SELECT` 和 `CREATE TABLE AS SELECT` 用于清理、形状、处理和扩充数据的查询。 这些查询的结果 **存储** 在数据湖上。 用于衡量此功能的使用情况的量度是计算小时数。

* **查询服务用户**:在您当前许可证中为Customer Journey Analytics、Adobe Real-time Customer Data Platform和/或Adobe Journey Optimizer提供的查询服务用户也可以与Data Distiller一起使用。 查询服务用户在功能之间共享。

* **临时用户**:临时用户是执行临时查询的用户。

* **批量用户**:批处理用户是执行批处理查询的用户。

* **报表API**:用于（内部或外部）进行数据获取调用的API。 扩展报表数据模型是从Adobe Experience Platform中的本机报表数据模型(如Real-Time CDP功能板数据模型)派生的。

下图概述了查询服务功能当前如何打包和授权：

![一个图表，用于说明与许可相关的查询服务功能的分发和打包。](./images/guardrails/query-capabilities.png)

## 限制类型

本文档中有两种类型的默认限制：

* **软限制**:您可以超出软限制，但软限制为系统性能提供了建议的准则。

* **硬限制**:硬限制提供绝对最大值。

>[!NOTE]
>
>本文档中概述的默认限制正在不断改进。 请定期查看以获取最新信息。

## 主要实体性能护栏

下表提供了在使用特定查询模式时执行查询时的建议护栏限制和说明。

**临时查询**

| 瓜德拉伊 | 限制 | 限制类型 | 描述 |
|---|---|---|---|
| 最大执行时间 | 10 分钟 | 硬 | 这定义了临时SQL查询的最长输出时间。 超过返回结果的时间限制会引发错误代码53400。 |
| 并发查询服务用户 | <ul><li>如应用程序产品说明中指定。</li><li>+5（购买了每个额外的Ad Hoc查询用户附加组件包）</li></ul> | 硬 | 这可定义可以同时为特定组织创建会话的用户数量。 如果超出并发限制，用户将收到 `Session Limit Reached` 错误。 |
| 查询并发 | <ul><li>如应用程序产品说明中指定。</li><li>+1（购买了每个额外的Ad Hoc查询用户附加SKU包）</li></ul> | 硬 | 这定义可为特定组织同时执行多少个查询。 如果超出并发限制，则查询将排入队列。 |
| 客户端连接器和结果输出限制 | 客户端连接器<ul><li>查询UI（100行）</li><li>第三方客户(50,000)</li><li>[!DNL PostgresSQL] 客户端(50,000)</li></ul> | 硬 | 查询结果可通过以下方式接收：<ul><li>查询服务UI</li><li>第三方客户</li><li>[!DNL PostgresSQL] 客户端</li></ul>注意：对输出计数添加限制可能会更快地返回结果。 例如， `LIMIT 5`, `LIMIT 10`，等等。 |
| 通过 | 客户端UI | 不适用 | 这定义了如何将结果提供给用户。 |

{style=&quot;table-layout:auto&quot;}

**批量查询**

| **瓜德拉伊** | **限制** | **限制类型** | **描述** |
|---|---|---|---|
| 最大执行时间 | 24 小时 | 硬 | 这定义批处理SQL查询的最长执行时间。<br>查询的处理时间取决于要处理的数据量和查询的复杂性。 |
| 未计划批的并发查询服务用户 | <ul><li>如应用程序产品说明中指定。</li><li>+5（购买了每个额外的Ad Hoc查询用户附加组件包）</li></ul> | 硬 | 对于未计划的批处理查询（例如，交互式模式下的CTAS/ITAS查询），它定义可以为特定组织同时创建会话的用户数量。 如果超出并发限制，用户将收到 `Session Limit Reached` 错误。 |
| 计划批的并发查询服务用户 | 无用户限制 | 不适用 | 计划的批处理查询是异步作业，因此不存在用户限制。 |
| 批处理数据的计算小时数 | 按照客户的Adobe Experience Platform Intelligence查询自定义SKU销售订单中指定的 | 柔和 | 这定义了允许客户执行批量查询以扫描、处理和将数据写回数据湖的计算时间范围（每年）。 |
| 查询并发 | 受支持 | 不适用 | 计划的批处理查询是异步作业，因此支持并发查询。 |
| 客户端连接器和结果输出限制 | 客户端连接器<ul><li>查询UI（行数没有上限）</li><li>第三方客户端（对行没有上限）</li><li>[!DNL PostgresSQL] 客户端（对行没有上限）</li><li>REST API（行数上限）</li></ul> | 硬 | 可使用以下方法获取查询结果：<ul><li>可以存储为派生的数据集</li><li>可插入到现有派生数据集中</li></ul>注意：查询结果中的记录计数编号没有上限。 |
| 通过 | 数据集 | 不适用 | 这定义了如何将结果提供给用户。 |

{style=&quot;table-layout:auto&quot;}

## 查询加速存储 {#query-accelerated-store}

下表提供了查询加速存储的建议护栏限制和说明。

| 瓜德拉伊 | 限制 | 限制类型 | 描述 |
|---|---|---|---|
| 查询并发 | 4 | 硬 | 为确保通过报表API对聚合数据的查询(包括增强数据模型(如Real-Time CDP数据模型)的查询)具有资源来有效执行，报表API通过为每个查询分配并发时隙来跟踪资源利用率。 系统将查询放入队列中，等待并发插槽变为可用或可从缓存中提供它们。 在任何给定时间，最多有四个并发查询槽。<br>如果您通过BI工具访问报表API，并且需要更多并发，则需要BI服务器。 |

{style=&quot;table-layout:auto&quot;}

## 后续步骤

阅读本文档后，您应更好地了解使用可用查询模式执行查询的默认限制。

有关查询服务的更多信息，请参阅以下文档：

* [查询服务API](./api/getting-started.md)
* [查询服务UI](./ui/overview.md)
